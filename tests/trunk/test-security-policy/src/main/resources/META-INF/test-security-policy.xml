<?xml version="1.0" encoding="ASCII"?>
<definitions xmlns="http://www.osoa.org/xmlns/sca/1.0"
    xmlns:sca="http://www.osoa.org/xmlns/sca/1.0"
    targetNamespace="http://fabric3.org/xmlns/sca/2.0-alpha"
    xmlns:f3="http://fabric3.org/xmlns/sca/2.0-alpha">
    
    <!-- Server policy using ws-policy -->
    <policySet name="testServerPolicyWs" 
               provides="sca:authentication.message" 
               appliesTo="@name='Axis2EchoService' and ../@name='EchoService' and $Operation='echoWs'">
        <f3:axisConfig module="rampart">
            <wsp:Policy wsu:Id="UTOverTransport" 
                        xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" 
                        xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy">
                <wsp:ExactlyOne>
                    <wsp:All>
                        <sp:SignedSupportingTokens xmlns:sp="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy">
                            <wsp:Policy>
                                <sp:UsernameToken sp:IncludeToken="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy/IncludeToken/AlwaysToRecipient" />
                            </wsp:Policy>
                        </sp:SignedSupportingTokens>
                        <ramp:RampartConfig xmlns:ramp="http://ws.apache.org/rampart/policy">                         
                            <ramp:passwordCallbackClass>org.fabric3.tests.security.PasswordHandler</ramp:passwordCallbackClass>
                        </ramp:RampartConfig>
                    </wsp:All>
                </wsp:ExactlyOne>
            </wsp:Policy>
        </f3:axisConfig>
    </policySet>
    
    <!-- Client policy using ws-policy -->
    <policySet name="testClientPolicyWs" 
               provides="sca:authentication.message" 
               appliesTo="@name='service' and ../@name='EchoTest' and $Operation='echoWs'">
        <f3:axisConfig module="rampart">
            <wsp:Policy wsu:Id="UTOverTransport" 
                        xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" 
                        xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy">
                <wsp:ExactlyOne>
                    <wsp:All>
                        <sp:SignedSupportingTokens xmlns:sp="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy">
                            <wsp:Policy>
                                <sp:UsernameToken sp:IncludeToken="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy/IncludeToken/AlwaysToRecipient" />
                            </wsp:Policy>
                        </sp:SignedSupportingTokens>
                        <ramp:RampartConfig xmlns:ramp="http://ws.apache.org/rampart/policy"> 
                            <ramp:user>Fred</ramp:user>
                            <ramp:passwordType>PasswordText</ramp:passwordType>
                            <ramp:passwordCallbackClass>org.fabric3.tests.security.PasswordHandler</ramp:passwordCallbackClass>
                        </ramp:RampartConfig>
                    </wsp:All>
                </wsp:ExactlyOne>
            </wsp:Policy>
        </f3:axisConfig>
    </policySet>

</definitions>