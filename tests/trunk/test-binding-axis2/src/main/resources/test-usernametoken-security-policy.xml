<?xml version="1.0" encoding="ASCII"?>
<!--
 Fabric3
 Copyright (c) 2009 Metaform Systems

 Fabric3 integration tests are licensed under the Apache 2.0 license.
 -->
<definitions xmlns="http://docs.oasis-open.org/ns/opencsa/sca/200903"
             xmlns:sca="http://docs.oasis-open.org/ns/opencsa/sca/200903"
             targetNamespace="urn:fabric3.org:policy"
             xmlns:f3-policy="urn:fabric3.org:policy">

    <!-- Authorization policy -->
    <policySet name="testServerUsernameTokenAuthrizationPolicy"
               provides="f3-policy:authorization.message"
               appliesTo="binding.ws and sca:OperationRef('Axis2EchoService/echoWsUsernameToken')"
               >
        <f3-policy:authorization roles="ADMIN"/>
    </policySet>

    <!-- Server policy using ws-policy -->
    <policySet name="testServerUsernameTokenPolicy"
               provides="sca:authentication.message"
               appliesTo="service/binding.ws and sca:OperationRef('Axis2EchoService/echoWsUsernameToken')">
        <f3-policy:axisConfig module="rampart">
            <wsp:Policy wsu:Id="UTOverTransport"
                        xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"
                        xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy">
                <wsp:ExactlyOne>
                    <wsp:All>
                        <sp:SignedSupportingTokens xmlns:sp="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy">
                            <wsp:Policy>
                                <sp:UsernameToken sp:IncludeToken="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy/IncludeToken/AlwaysToRecipient"/>
                            </wsp:Policy>
                        </sp:SignedSupportingTokens>
                        <ramp:RampartConfig xmlns:ramp="http://ws.apache.org/rampart/policy">
                            <ramp:passwordCallbackClass>org.fabric3.tests.security.AuthenticationHandler</ramp:passwordCallbackClass>
                        </ramp:RampartConfig>
                    </wsp:All>
                </wsp:ExactlyOne>
            </wsp:Policy>
        </f3-policy:axisConfig>
    </policySet>

    <!-- Client policy using ws-policy -->
    <policySet name="testClientUsernameTokenPolicy"
               provides="sca:authentication.message"
               appliesTo="reference/binding.ws and sca:OperationRef('Axis2EchoService/echoWsUsernameToken')">
        <f3-policy:axisConfig module="rampart">
            <wsp:Policy wsu:Id="UTOverTransport"
                        xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"
                        xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy">
                <wsp:ExactlyOne>
                    <wsp:All>
                        <sp:SignedSupportingTokens xmlns:sp="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy">
                            <wsp:Policy>
                                <sp:UsernameToken sp:IncludeToken="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy/IncludeToken/AlwaysToRecipient"/>
                            </wsp:Policy>
                        </sp:SignedSupportingTokens>
                        <ramp:RampartConfig xmlns:ramp="http://ws.apache.org/rampart/policy">
                            <ramp:user>Fred</ramp:user>
                            <ramp:passwordType>PasswordText</ramp:passwordType>
                            <ramp:passwordCallbackClass>org.fabric3.tests.security.PasswordHandler</ramp:passwordCallbackClass>
                        </ramp:RampartConfig>
                    </wsp:All>
                </wsp:ExactlyOne>
            </wsp:Policy>
        </f3-policy:axisConfig>
    </policySet>

</definitions>