<?xml version="1.0" encoding="ASCII"?>
<!--
 Fabric3
 Copyright (c) 2009 Metaform Systems

 Fabric3 integration tests are licensed under the Apache 2.0 license.
 -->
<definitions xmlns="http://docs.oasis-open.org/ns/opencsa/sca/200903"
             xmlns:sca="http://docs.oasis-open.org/ns/opencsa/sca/200903"
             targetNamespace="urn:fabric3.org:policy"
             xmlns:f3-policy="urn:fabric3.org:policy"
             xmlns:xsd="http://www.w3.org/2001/XMLSchema"
             xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"
             xmlns:wsp="http://www.w3.org/ns/ws-policy"
             xmlns:wsam="http://www.w3.org/2007/05/addressing/metadata"
             xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702">

    <policySet name="usernameTokenPolicy" provides="sca:clientAuthentication.message" appliesTo="binding.ws">
        <Policy wsu:Id="UsernameTokenPolicy" xmlns="http://www.w3.org/ns/ws-policy">
            <wsp:ExactlyOne>
                <wsp:All>
                    <wsam:Addressing wsp:Optional="false"/>
                    <sp:TransportBinding>
                        <wsp:Policy>
                            <sp:TransportToken>
                                <wsp:Policy>
                                    <sp:HttpsToken RequireClientCertificate="false"/>
                                </wsp:Policy>
                            </sp:TransportToken>
                            <sp:Layout>
                                <wsp:Policy>
                                    <sp:Lax/>
                                </wsp:Policy>
                            </sp:Layout>
                            <sp:IncludeTimestamp/>
                            <sp:AlgorithmSuite>
                                <wsp:Policy>
                                    <sp:Basic128/>
                                </wsp:Policy>
                            </sp:AlgorithmSuite>
                        </wsp:Policy>
                    </sp:TransportBinding>
                    <sp:Wss10/>
                    <sp:SignedSupportingTokens>
                        <wsp:Policy>
                            <sp:UsernameToken sp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient">
                                <wsp:Policy>
                                    <sp:WssUsernameToken10/>
                                </wsp:Policy>
                            </sp:UsernameToken>
                        </wsp:Policy>
                    </sp:SignedSupportingTokens>
                </wsp:All>
            </wsp:ExactlyOne>
        </Policy>
    </policySet>

</definitions>